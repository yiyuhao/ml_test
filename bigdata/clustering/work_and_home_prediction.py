"""
@license : Copyright(C), WAYZ
@author: Xie Wangyi
@contact: wangyi.xie@wayz.ai
"""
import json

import numpy as np

from bigdata.clustering.nodes import trace_data_to_fence_list, fence_list_to_work_and_home


def main():
    trace_data = (
        [[1532854650494, 104.270069, 30.554828, 1, 0], [1542584753000, 104.03225, 30.625973, 1, 0],
         [1542608672000, 104.03596, 30.62394, 1, 0], [1542708103000, 104.03225, 30.625973, 1, 0],
         [1542816846000, 104.03225, 30.625973, 1, 0], [1542989970000, 104.27235, 30.549469, 1, 0],
         [1543029655000, 104.27235, 30.549469, 1, 0], [1543064864000, 104.27235, 30.549469, 1, 0],
         [1543124789000, 104.27235, 30.549469, 1, 0], [1543185106000, 104.27235, 30.549469, 1, 0],
         [1543226026000, 104.03225, 30.625973, 1, 0], [1543313164000, 104.03225, 30.625973, 1, 0],
         [1543365811000, 104.03596, 30.62394, 1, 0], [1543373802000, 104.03596, 30.62394, 1, 0],
         [1543709046000, 104.03225, 30.625973, 1, 0], [1543794274000, 104.03225, 30.625973, 1, 0],
         [1543798321000, 104.03596, 30.62394, 1, 0], [1543826991000, 104.03596, 30.62394, 1, 0],
         [1543840861000, 104.03225, 30.625973, 1, 0], [1543880964000, 104.03225, 30.625973, 1, 0],
         [1543884144000, 104.03596, 30.62394, 1, 0], [1543929377000, 104.03225, 30.625973, 1, 0],
         [1544094702000, 104.03225, 30.625973, 1, 0],
         [1544237235514, 104.032367, 30.625998, 2, 254],
         [1544237362889, 104.032435, 30.625952, 2, 1833],
         [1544238822778, 104.03241, 30.625942, 2, 130], [1544239076360, 104.03248, 30.626009, 1, 0],
         [1544239317410, 104.032425, 30.625994, 1, 0], [1544239439485, 104.0327, 30.625957, 1, 0],
         [1544239558543, 104.03225, 30.626026, 1, 0], [1544239678581, 104.0324, 30.625992, 1, 0],
         [1544239800826, 104.032355, 30.625929, 2, 117],
         [1544240044836, 104.032455, 30.626049, 6, 1529],
         [1544240313868, 104.032361, 30.626045, 3, 437],
         [1544241147240, 104.032394, 30.625925, 1, 0], [1544241421115, 104.03233, 30.626049, 1, 0],
         [1544241781379, 104.03235, 30.625265, 1, 0], [1544241905791, 104.03229, 30.626034, 1, 0],
         [1544486307000, 104.03225, 30.625973, 1, 0], [1544490178000, 104.03596, 30.62394, 2, 77],
         [1544503144000, 104.03225, 30.625973, 1, 0], [1544507558000, 104.03596, 30.62394, 1, 0],
         [1544522180000, 104.03225, 30.625973, 1, 0], [1544580654000, 104.03596, 30.62394, 1, 0],
         [1544626016000, 104.03225, 30.625973, 1, 0], [1544783768000, 104.03225, 30.625973, 1, 0],
         [1544834591000, 104.03225, 30.625973, 1, 0], [1544943808000, 104.03225, 30.625973, 1, 0],
         [1545094801000, 104.03596, 30.62394, 2, 918], [1545125044000, 104.03225, 30.625973, 1, 0],
         [1545181342000, 104.03596, 30.62394, 1, 0], [1545350727000, 104.03225, 30.625973, 1, 0],
         [1545389556000, 104.19503, 30.583834, 1, 0], [1545442449000, 104.27235, 30.549469, 1, 0],
         [1545581213000, 104.03225, 30.625973, 1, 0], [1545626996000, 104.03596, 30.62394, 1, 0],
         [1545643257000, 104.03225, 30.625973, 1, 0], [1545662992000, 104.03225, 30.625973, 1, 0],
         [1546220048000, 104.03225, 30.625973, 1, 0], [1546234728000, 104.27235, 30.549469, 1, 0],
         [1546267608000, 104.27235, 30.549469, 1, 0], [1546532949000, 104.03225, 30.625973, 1, 0],
         [1546570518000, 104.03596, 30.62394, 1, 0], [1546596537000, 104.03225, 30.625973, 1, 0],
         [1546618529000, 104.03225, 30.625973, 1, 0], [1546651034192, 104.03238, 30.62597, 1, 0],
         [1546651074757, 104.03224, 30.625975, 1, 0], [1546651247212, 104.0323, 30.625967, 1, 0],
         [1546651373565, 104.032167, 30.625936, 3, 311],
         [1546651823613, 104.03241, 30.625998, 1, 0], [1546652025787, 104.03223, 30.626026, 1, 0],
         [1546652216922, 104.032295, 30.62604, 1, 0], [1546652364277, 104.03249, 30.62594, 1, 0],
         [1546652486181, 104.0323, 30.626003, 1, 0], [1546652660538, 104.0322, 30.625977, 2, 205],
         [1546653007951, 104.0323, 30.625938, 1, 0],
         [1546653141668, 104.032415, 30.625951, 2, 1086],
         [1546653278963, 104.032355, 30.62603, 3, 284],
         [1546653692415, 104.03233, 30.625948, 2, 127], [1546653956680, 104.03243, 30.626026, 1, 0],
         [1546654086127, 104.032237, 30.625914, 3, 520],
         [1546654754065, 104.032394, 30.625963, 1, 0], [1546654882619, 104.032455, 30.62611, 1, 0],
         [1546655016195, 104.03226, 30.625996, 1, 0],
         [1546655259798, 104.032375, 30.626065, 2, 146],
         [1546655534484, 104.03209, 30.625943, 3, 577], [1546655964977, 104.03237, 30.62606, 1, 0],
         [1546656264104, 104.0323, 30.626017, 1, 0], [1546656466645, 104.032196, 30.625952, 1, 0],
         [1546656597463, 104.03238, 30.625793, 1, 0], [1546656721059, 104.03232, 30.62607, 1, 0],
         [1546656948135, 104.03223, 30.626009, 1, 0], [1546657193952, 104.03231, 30.626001, 1, 0],
         [1546657595293, 104.03239, 30.625982, 1, 0], [1546657989000, 104.03225, 30.625973, 1, 0],
         [1546658022955, 104.0322, 30.625975, 1, 0], [1546660911000, 104.03326, 30.63128, 1, 0],
         [1546662540000, 104.03225, 30.625973, 1, 0], [1546671647000, 104.03225, 30.625973, 1, 0],
         [1546686373000, 104.06353, 30.629534, 1, 0], [1546703330000, 104.03225, 30.625973, 1, 0],
         [1546741558240, 104.03239, 30.62604, 1, 0], [1546741708570, 104.03224, 30.62599, 1, 0],
         [1546741762090, 104.03213, 30.625206, 1, 0], [1546741968300, 104.03234, 30.625868, 1, 0],
         [1546742102481, 104.032385, 30.626069, 2, 196],
         [1546742595271, 104.032234, 30.625961, 1, 0], [1546742718650, 104.03245, 30.626024, 1, 0],
         [1546742846059, 104.032166, 30.626106, 1, 0],
         [1546742990559, 104.032394, 30.626051, 4, 600],
         [1546743818782, 104.032616, 30.62584, 1, 0],
         [1546743960615, 104.032343, 30.626033, 4, 547], [1546744660251, 104.03224, 30.62597, 1, 0],
         [1546744795704, 104.03242, 30.626068, 7, 1068],
         [1546745993846, 104.032234, 30.625813, 1, 0], [1546746123071, 104.03241, 30.626097, 1, 0],
         [1546746242851, 104.0322, 30.625954, 1, 0], [1546746362775, 104.03235, 30.626043, 6, 520],
         [1546747003050, 104.032166, 30.625992, 1, 0],
         [1546747143040, 104.032333, 30.626031, 3, 260],
         [1546790807000, 104.03225, 30.625973, 1, 0], [1546822838000, 104.03596, 30.62394, 2, 79],
         [1546854235000, 104.03225, 30.625973, 1, 0], [1546905896000, 104.03225, 30.625973, 1, 0],
         [1547082097000, 104.03596, 30.62394, 1, 0], [1547453451000, 104.03596, 30.62394, 1, 0],
         [1547471682000, 104.03225, 30.625973, 1, 0], [1547478180000, 104.03225, 30.625973, 2, 343],
         [1547828727000, 104.03225, 30.625973, 1, 0], [1547919057000, 104.03225, 30.625973, 1, 0],
         [1547979729000, 104.03225, 30.625973, 3, 1289],
         [1547987047000, 104.03225, 30.625973, 1, 0],
         [1548208297000, 107.464096, 31.213688, 2, 164],
         [1548210677000, 107.46769, 31.211157, 1, 0], [1548218106000, 107.453103, 31.198636, 2, 0],
         [1548218106000, 107.45401, 31.198814, 1, 0], [1548263392000, 104.03225, 30.625973, 2, 92],
         [1548334739000, 104.03225, 30.625973, 1, 0], [1548345911000, 104.03225, 30.625973, 1, 0],
         [1548497009000, 104.03225, 30.625973, 1, 0], [1548499796000, 104.03326, 30.63128, 1, 0],
         [1548514126000, 104.03225, 30.625973, 2, 562], [1548543884000, 104.03225, 30.625973, 1, 0],
         [1548556804000, 104.03609, 30.628819, 1, 0],
         [1548591575000, 104.03225, 30.625973, 3, 1076],
         [1548602808000, 104.03225, 30.625973, 1, 0], [1549016007006, 104.03229, 30.626049, 1, 0],
         [1549016129298, 104.032265, 30.626028, 1, 0], [1549016266218, 104.0323, 30.626007, 1, 0],
         [1549016439687, 104.03218, 30.625708, 1, 0], [1549016560631, 104.03234, 30.626034, 1, 0],
         [1549038686000, 104.03225, 30.625973, 1, 0], [1549072514000, 104.03596, 30.62394, 1, 0],
         [1549096196000, 104.031525, 30.625954, 1, 0], [1549213818000, 104.27235, 30.549469, 1, 0],
         [1549297613000, 104.272675, 30.549736, 1, 0], [1549410246000, 104.27235, 30.549469, 1, 0],
         [1549729187000, 104.27255, 30.54994, 1, 0], [1549782505000, 104.03225, 30.625973, 2, 102],
         [1549811488000, 104.03225, 30.625973, 1, 0], [1549977441000, 104.03225, 30.625973, 1, 0],
         [1549988715000, 104.03225, 30.625973, 1, 0], [1550019890000, 104.03596, 30.62394, 1, 0],
         [1550051693000, 104.03225, 30.625973, 1, 0], [1550053047000, 104.03225, 30.625973, 1, 0],
         [1550071381000, 104.03225, 30.625973, 2, 41], [1550162635000, 104.03225, 30.625973, 1, 0],
         [1550192406000, 104.03596, 30.62394, 2, 130], [1550227645000, 104.03225, 30.625973, 1, 0],
         [1550244462000, 104.03225, 30.625973, 1, 0], [1550246703000, 104.03225, 30.625973, 1, 0],
         [1550381753000, 104.03225, 30.625973, 1, 0], [1550419298000, 104.03225, 30.625973, 1, 0],
         [1550488209000, 104.03326, 30.63128, 1, 0], [1550501824000, 104.03225, 30.625973, 1, 0],
         [1550532935000, 104.03225, 30.625973, 1, 0], [1550573764000, 104.03326, 30.63128, 1, 0],
         [1550588121000, 104.03225, 30.625973, 1, 0], [1550678436000, 104.03225, 30.625973, 1, 0],
         [1550711277000, 104.03596, 30.62394, 1, 0], [1550724147000, 104.032295, 30.624542, 1, 0],
         [1550724409000, 104.03225, 30.625973, 1, 0], [1550740039000, 104.03596, 30.62394, 1, 0],
         [1550746279000, 104.03225, 30.625973, 1, 0], [1550750498000, 104.03326, 30.63128, 1, 0],
         [1550758697000, 104.03225, 30.625973, 1, 0], [1550763465000, 104.03225, 30.625973, 1, 0],
         [1550767387000, 104.03225, 30.625973, 1, 0], [1550796425000, 104.03225, 30.625973, 1, 0],
         [1550805072000, 104.060616, 30.641676, 1, 0], [1550811440000, 104.03596, 30.62394, 1, 0],
         [1551024553000, 104.03225, 30.625973, 1, 0], [1551200444000, 104.03225, 30.625973, 1, 0],
         [1551242677000, 104.03596, 30.62394, 1, 0], [1551263367000, 104.03225, 30.625973, 1, 0],
         [1551265081000, 104.03326, 30.63128, 1, 0], [1551279773000, 104.03225, 30.625973, 1, 0],
         [1551284537000, 104.03225, 30.625973, 1, 0], [1551316675000, 104.03596, 30.62394, 1, 0],
         [1551329185000, 104.03596, 30.62394, 1, 0], [1551345766000, 104.03596, 30.62394, 1, 0],
         [1551348834000, 104.03225, 30.625973, 1, 0], [1551356704000, 104.03326, 30.63128, 1, 0],
         [1551357013000, 104.03326, 30.63128, 1, 0], [1551362420000, 104.03225, 30.625973, 2, 133],
         [1551458322000, 104.03225, 30.625973, 1, 0], [1551628920000, 104.03225, 30.625973, 1, 0],
         [1551744406000, 104.03225, 30.625973, 1, 0], [1551753039000, 104.03596, 30.62394, 1, 0],
         [1551755213000, 104.03596, 30.62394, 2, 74], [1551771459000, 104.03596, 30.62394, 2, 1017],
         [1551772374000, 104.03596, 30.62394, 1, 0], [1551802879000, 104.03225, 30.625973, 1, 0],
         [1551834662000, 104.03596, 30.62394, 1, 0], [1551879691000, 104.03225, 30.625973, 1, 0],
         [1551917297000, 104.03225, 30.625973, 1, 0], [1551973271000, 104.03225, 30.625973, 1, 0],
         [1551996704000, 104.03225, 30.625973, 1, 0], [1552007311000, 104.03596, 30.62394, 2, 23],
         [1552028880000, 104.03596, 30.62394, 1, 0], [1552047665000, 104.27235, 30.549469, 1, 0],
         [1552228657000, 104.03225, 30.625973, 1, 0], [1552348948000, 104.03225, 30.625973, 2, 0],
         [1552352592000, 104.03596, 30.62394, 2, 0], [1552365789000, 104.03596, 30.62394, 2, 0],
         [1552440845000, 104.03596, 30.62394, 1, 0], [1552452503000, 104.03596, 30.62394, 1, 0],
         [1552487871000, 104.03225, 30.625973, 1, 0], [1552521832000, 104.03225, 30.625973, 1, 0],
         [1552579547000, 104.03225, 30.625973, 1, 0], [1552612396000, 104.03596, 30.62394, 1, 0],
         [1552624645000, 104.03596, 30.62394, 1, 0], [1552643365000, 104.03225, 30.625973, 2, 105],
         [1552666416000, 104.27235, 30.549469, 1, 0], [1552740009000, 104.27235, 30.549469, 1, 0],
         [1552867677000, 104.03225, 30.625973, 1, 0], [1552873529000, 104.03596, 30.62394, 1, 0],
         [1552918700000, 104.03225, 30.625973, 1, 0], [1552924985000, 104.03225, 30.625973, 1, 0],
         [1552958878000, 104.03596, 30.62394, 1, 0], [1552987190000, 104.03596, 30.62394, 1, 0],
         [1552991120000, 104.03225, 30.625973, 3, 705], [1553040631000, 104.03225, 30.625973, 1, 0],
         [1553054249000, 104.03596, 30.62394, 3, 2835], [1553063292000, 104.03596, 30.62394, 2, 25],
         [1553079215000, 104.03596, 30.62394, 2, 597], [1553080054000, 104.03596, 30.62394, 1, 0],
         [1553094178000, 104.03225, 30.625973, 1, 0], [1553178813000, 104.06353, 30.629534, 2, 372],
         [1553178895000, 104.06353, 30.629534, 2, 86], [1553182936000, 104.03225, 30.625973, 1, 0],
         [1553186623000, 104.03225, 30.625973, 1, 0], [1553229617000, 104.03596, 30.62394, 1, 0],
         [1553269467000, 104.03225, 30.625973, 1, 0], [1553270233000, 104.03225, 30.625973, 1, 0],
         [1553558955000, 104.03225, 30.625973, 1, 0], [1553571423000, 104.03596, 30.62394, 1, 0],
         [1553575905000, 104.03596, 30.62394, 1, 0], [1553603487000, 104.03225, 30.625973, 1, 0],
         [1553608905000, 104.03225, 30.625973, 1, 0], [1553703444000, 104.03225, 30.625973, 1, 0],
         [1553743263000, 104.03596, 30.62394, 1, 0], [1553768418000, 104.03225, 30.625973, 2, 1181],
         [1553906014000, 104.03225, 30.625973, 1, 0], [1553911010000, 104.03225, 30.625973, 1, 0],
         [1553916229000, 104.04056, 30.660181, 1, 0], [1553927218000, 104.03225, 30.625973, 1, 0],
         [1553953904000, 104.06353, 30.629534, 1, 0], [1553962631000, 104.03225, 30.625973, 3, 459],
         [1554035542000, 104.06353, 30.629534, 1, 0], [1554039456000, 104.06353, 30.629534, 1, 0],
         [1554082687000, 104.03596, 30.62394, 1, 0], [1554092984000, 104.03596, 30.62394, 1, 0],
         [1554109795000, 104.03225, 30.625973, 2, 144], [1554249748000, 104.03225, 30.625973, 1, 0],
         [1554265501000, 104.03596, 30.62394, 1, 0], [1554300270000, 104.06353, 30.629534, 1, 0],
         [1554303897000, 104.03225, 30.625973, 2, 257], [1554767319000, 104.03225, 30.625973, 1, 0],
         [1554818334000, 104.06353, 30.629534, 1, 0], [1554821020000, 104.03225, 30.625973, 1, 0],
         [1554826923000, 104.03225, 30.625973, 1, 0], [1554870840000, 104.03596, 30.62394, 1, 0],
         [1554904650000, 104.03225, 30.625973, 2, 141], [1554941733000, 104.03225, 30.625973, 1, 0],
         [1554957874000, 104.03596, 30.62394, 1, 0], [1554989598000, 104.03449, 30.632256, 1, 0],
         [1555088319787, 104.0323, 30.625986, 1, 0], [1555176757000, 104.27235, 30.549469, 1, 0],
         [1555217391000, 104.26239, 30.571888, 1, 0]]
    )

    print(f'trace:{json.dumps(trace_data)}')

    fence_list, cluster_centers, cluster_centers_weights = trace_data_to_fence_list(trace_data)
    result = np.hstack([cluster_centers, np.transpose(np.array([cluster_centers_weights]))])
    print('cluster data:' + json.dumps(result.tolist()))

    work_fence, home_fence = fence_list_to_work_and_home(fence_list)

    print(f'work:{work_fence.tolist() if work_fence is not None else None}')
    print(f'home:{home_fence.tolist() if home_fence  is not None else None}')


if __name__ == '__main__':
    main()
